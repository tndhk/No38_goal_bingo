dev_tasks:
  project: bingo_goal_app
  version: "1.0"
  date: "2026-01-16"
  updated: "2026-01-17"
  mvp_target: "2026-01-31"
  mvp_status: completed

  # 技術基盤タスク（ストーリー横断）
  foundation:
    - id: FND001
      title: "プロジェクト初期設定"
      status: completed
      priority: 0
      tasks:
        - id: FND001-T1
          title: "技術選定（SvelteKit or Next.js）"
          status: completed
          estimate: 1h
          acceptance:
            - "フレームワーク決定と理由を文書化"
            - "プロジェクト初期化完了"
          notes: "SvelteKit v2.49.1 + Svelte 5を採用"

        - id: FND001-T2
          title: "ディレクトリ構成とコーディング規約"
          status: completed
          estimate: 1h
          depends_on: [FND001-T1]
          acceptance:
            - "src/配下の構成が決定"
            - "ESLint/Prettier設定"
            - "TypeScript設定"
          notes: "src/lib/{components,stores,utils,types,constants,actions}構成"

        - id: FND001-T3
          title: "デザイントークン/テーマ設定"
          status: completed
          estimate: 1h
          depends_on: [FND001-T2]
          acceptance:
            - "colors, typography, spacingの定数化"
            - "Tailwind or CSS変数で実装"
          notes: "src/lib/constants/tokens.ts実装済み"

        - id: FND001-T4
          title: "共通コンポーネント基盤"
          status: completed
          estimate: 2h
          depends_on: [FND001-T3]
          acceptance:
            - "Button, Modal, Dialog等の基礎コンポーネント"
            - "レスポンシブ対応確認"
          notes: "Button, Modal, Dialog, SaveIndicator実装済み"

  # Epic別ストーリー・タスク
  epics:
    # ========== EP001: ビンゴボード管理 ==========
    - id: EP001
      title: "ビンゴボード管理"
      stories:
        # ST001: 新しいビンゴボードを作成する
        - id: ST001
          title: "新しいビンゴボードを作成する"
          status: completed
          priority: 1
          solution: SL001
          screens: [SC001, SC004]
          tasks:
            - id: ST001-T1
              title: "BingoBoard型定義"
              status: completed
              estimate: 30m
              depends_on: [FND001-T2]
              acceptance:
                - "Board, Cell, Yearの型定義"
                - "9マスの位置enum（topLeft, topCenter, ...）"
              notes: "src/lib/types/bingo.ts実装済み"

            - id: ST001-T2
              title: "ビンゴボード状態管理"
              status: completed
              estimate: 1h
              depends_on: [ST001-T1]
              acceptance:
                - "boards配列の状態管理"
                - "currentBoardIdの管理"
                - "CRUD操作関数"
              notes: "src/lib/stores/boardStore.ts実装済み"

            - id: ST001-T3
              title: "BingoGridコンポーネント"
              status: completed
              estimate: 2h
              depends_on: [ST001-T1, FND001-T4]
              acceptance:
                - "3x3グリッドレイアウト"
                - "モバイル対応（タッチ操作）"
                - "マス要素のスタイリング"
              notes: "BingoGrid + BingoCell実装済み"

            - id: ST001-T4
              title: "新規作成ボタンとフロー"
              status: completed
              estimate: 1h
              depends_on: [ST001-T2, ST001-T3]
              acceptance:
                - "新規作成ボタン表示"
                - "年度選択UI"
                - "ボード生成処理"
              notes: "+page.svelteに年度選択ダイアログ実装済み"

        # ST002: ビンゴボードを一覧で見る
        - id: ST002
          title: "ビンゴボードを一覧で見る"
          status: completed
          priority: 2
          solution: SL001
          screens: [SC004]
          tasks:
            - id: ST002-T1
              title: "BoardListコンポーネント"
              status: completed
              estimate: 1.5h
              depends_on: [ST001-T2]
              acceptance:
                - "年度順のボード一覧表示"
                - "各ボードの達成状況サマリー"
                - "タップで詳細画面遷移"
              notes: "BoardList.svelte実装済み、テスト8件合格"

            - id: ST002-T2
              title: "/boardsルート実装"
              status: completed
              estimate: 1h
              depends_on: [ST002-T1]
              acceptance:
                - "ボード一覧ページ"
                - "ホーム画面との遷移"
              notes: "routes/boards/+page.svelte実装済み"

        # ST003: 年度を切り替える
        - id: ST003
          title: "年度を切り替える"
          status: completed
          priority: 3
          solution: SL001
          screens: [SC001, SC004]
          tasks:
            - id: ST003-T1
              title: "YearSelectorコンポーネント"
              status: completed
              estimate: 1h
              depends_on: [ST001-T2]
              acceptance:
                - "ドロップダウンUI"
                - "年度リスト（過去〜未来）"
                - "選択時のボード切り替え"
              notes: "+page.svelteにセレクトボックスとして実装"

            - id: ST003-T2
              title: "存在しない年度の処理"
              status: completed
              estimate: 30m
              depends_on: [ST003-T1, ST001-T4]
              acceptance:
                - "新規作成を促すUI"
                - "ワンタップで作成可能"
              notes: "availableYears derived + 新規作成ダイアログ"

        # ST004: ビンゴボードを削除する
        - id: ST004
          title: "ビンゴボードを削除する"
          status: completed
          priority: 8
          solution: SL001
          screens: [SC001, SC005]
          tasks:
            - id: ST004-T1
              title: "削除確認ダイアログ"
              status: completed
              estimate: 1h
              depends_on: [FND001-T4]
              acceptance:
                - "確認メッセージ表示"
                - "削除/キャンセルボタン"
                - "誤操作防止"
              notes: "Dialog.svelte + boards/+page.svelte実装済み"

            - id: ST004-T2
              title: "削除処理とリダイレクト"
              status: completed
              estimate: 30m
              depends_on: [ST004-T1, ST001-T2]
              acceptance:
                - "ボード削除処理"
                - "一覧画面へリダイレクト"
                - "ストレージからも削除"
              notes: "deleteBoard関数 + autoSave実装済み"

    # ========== EP002: 目標管理 ==========
    - id: EP002
      title: "目標管理"
      stories:
        # ST005: マスに目標を入力する
        - id: ST005
          title: "マスに目標を入力する"
          status: completed
          priority: 4
          solution: SL001
          screens: [SC001, SC002]
          tasks:
            - id: ST005-T1
              title: "GoalInputModalコンポーネント"
              status: completed
              estimate: 1.5h
              depends_on: [FND001-T4, ST001-T3]
              acceptance:
                - "マス位置表示"
                - "テキスト入力（50文字制限）"
                - "保存/キャンセル/クリアボタン"
              notes: "GoalInputModal.svelte実装済み、テスト8件合格"

            - id: ST005-T2
              title: "マスタップ→モーダル表示"
              status: completed
              estimate: 30m
              depends_on: [ST005-T1]
              acceptance:
                - "タップイベント処理"
                - "モーダル開閉状態管理"
              notes: "BingoCell onTapハンドラ + isModalOpen状態"

            - id: ST005-T3
              title: "目標保存処理"
              status: completed
              estimate: 30m
              depends_on: [ST005-T2, ST001-T2]
              acceptance:
                - "状態更新"
                - "マスに目標テキスト表示"
              notes: "updateCell関数 + autoSave実装済み"

        # ST006: 目標を達成済みにする
        - id: ST006
          title: "目標を達成済みにする"
          status: completed
          priority: 5
          solution: SL001
          screens: [SC001]
          tasks:
            - id: ST006-T1
              title: "達成トグル機能"
              status: completed
              estimate: 1h
              depends_on: [ST005-T3]
              acceptance:
                - "長押しで達成/未達成切り替え"
                - "視覚的フィードバック"
                - "状態永続化"
              notes: "longPress action + toggleAchieved関数実装済み"

            - id: ST006-T2
              title: "達成マスのスタイリング"
              status: completed
              estimate: 1h
              depends_on: [ST006-T1]
              acceptance:
                - "達成色（#10B981）適用"
                - "未達成色（#E5E7EB）適用"
                - "トランジションアニメーション"
              notes: "BingoCell achievedスタイル実装済み"

        # ST007: 進捗を確認する
        - id: ST007
          title: "進捗を確認する"
          status: completed
          priority: 6
          solution: SL003
          screens: [SC001]
          tasks:
            - id: ST007-T1
              title: "進捗計算ロジック"
              status: completed
              estimate: 30m
              depends_on: [ST006-T1]
              acceptance:
                - "達成数カウント"
                - "達成率計算"
                - "ビンゴまでの残りマス判定"
              notes: "bingo.ts getProgressSummary実装済み、テスト31件合格"

            - id: ST007-T2
              title: "ProgressDisplayコンポーネント"
              status: completed
              estimate: 1h
              depends_on: [ST007-T1]
              acceptance:
                - "「5/9 達成」表示"
                - "達成率パーセント表示"
                - "「あと1マスでビンゴ！」ヒント"
              notes: "ProgressDisplay.svelte実装済み、テスト8件合格"

    # ========== EP003: 達成演出 ==========
    - id: EP003
      title: "達成演出"
      stories:
        # ST008: ビンゴ達成でアニメーションを見る
        - id: ST008
          title: "ビンゴ達成でアニメーションを見る"
          status: completed
          priority: 7
          solution: SL002
          screens: [SC001, SC003]
          tasks:
            - id: ST008-T1
              title: "ビンゴ判定ロジック"
              status: completed
              estimate: 1h
              depends_on: [ST006-T1]
              acceptance:
                - "縦3列の判定"
                - "横3行の判定"
                - "斜め2本の判定"
                - "達成ライン配列を返す"
              notes: "bingo.ts getCompletedLines + BINGO_LINES定数"

            - id: ST008-T2
              title: "ビンゴラインハイライト"
              status: completed
              estimate: 1h
              depends_on: [ST008-T1]
              acceptance:
                - "揃ったラインを強調表示（#FBBF24）"
                - "複数ライン同時対応"
              notes: "BingoCell isHighlighted prop + bingoGlowスタイル"

            - id: ST008-T3
              title: "BingoCelebrationオーバーレイ"
              status: completed
              estimate: 2h
              depends_on: [ST008-T1]
              acceptance:
                - "「BINGO!」テキスト大きく表示"
                - "紙吹雪アニメーション"
                - "光るエフェクト"
                - "タップで閉じる"
              notes: "celebration.ts canvas-confetti実装、テスト6件合格"

        # ST009: 複数ビンゴの達成を見る
        - id: ST009
          title: "複数ビンゴの達成を見る"
          status: completed
          priority: 9
          solution: SL002
          screens: [SC003]
          tasks:
            - id: ST009-T1
              title: "複数ビンゴ表示"
              status: completed
              estimate: 1h
              depends_on: [ST008-T3]
              acceptance:
                - "「ダブルビンゴ達成！」等の表示"
                - "達成ライン数カウント表示"
              notes: "ProgressDisplay bingoCount表示対応"

            - id: ST009-T2
              title: "全マス達成（パーフェクト）演出"
              status: completed
              estimate: 1h
              depends_on: [ST009-T1]
              acceptance:
                - "9/9達成時の特別演出"
                - "「PERFECT!」表示"
              notes: "celebratePerfect() 3秒間の両サイド紙吹雪演出"

    # ========== EP004: データ永続化 ==========
    - id: EP004
      title: "データ永続化"
      stories:
        # ST010: データを自動保存する
        - id: ST010
          title: "データを自動保存する"
          status: completed
          priority: 10
          solution: SL004
          screens: [SC001]
          tasks:
            - id: ST010-T1
              title: "LocalStorage永続化層"
              status: completed
              estimate: 1h
              depends_on: [ST001-T2]
              acceptance:
                - "保存/読み込み関数"
                - "JSON形式でのシリアライズ"
                - "エラーハンドリング"
              notes: "storage.ts saveToStorage/loadFromStorage、テスト6件合格"

            - id: ST010-T2
              title: "自動保存トリガー"
              status: completed
              estimate: 30m
              depends_on: [ST010-T1]
              acceptance:
                - "状態変更時の自動保存"
                - "デバウンス処理"
              notes: "boardStore triggerAutoSave 500msデバウンス"

            - id: ST010-T3
              title: "保存状態インジケータ"
              status: completed
              estimate: 30m
              depends_on: [ST010-T2]
              acceptance:
                - "「保存中...」表示"
                - "「保存完了」表示"
              notes: "SaveIndicator.svelte isSaving状態表示、テスト3件合格"

    # ========== EP005: 認証・クラウド同期 ==========
    - id: EP005
      title: "認証・クラウド同期"
      stories:
        # ST011: Googleでログインする
        - id: ST011
          title: "Googleでログインする"
          status: completed
          priority: 11
          solution: SL005
          screens: [SC001, SC006]
          tasks:
            - id: ST011-T1
              title: "Supabase クライアント設定"
              status: completed
              estimate: 1h
              depends_on: [FND001-T2]
              acceptance:
                - "Supabaseクライアント初期化"
                - "環境変数から設定読み込み"
                - "SSR/CSR両対応"
              notes: "src/lib/supabase/client.ts + hooks.server.ts実装済み"

            - id: ST011-T2
              title: "認証ストア実装"
              status: completed
              estimate: 1h
              depends_on: [ST011-T1]
              acceptance:
                - "user/session状態管理"
                - "isAuthenticated派生状態"
                - "認証状態変更の購読"
              notes: "src/lib/stores/authStore.ts実装済み"

            - id: ST011-T3
              title: "AuthButtonコンポーネント"
              status: completed
              estimate: 1.5h
              depends_on: [ST011-T2]
              acceptance:
                - "未ログイン時: Googleログインボタン"
                - "ログイン時: ユーザー情報とログアウト"
                - "ローディング状態表示"
              notes: "src/lib/components/ui/AuthButton.svelte実装済み"

            - id: ST011-T4
              title: "OAuth コールバック処理"
              status: completed
              estimate: 1h
              depends_on: [ST011-T1]
              acceptance:
                - "認証コールバックルート"
                - "エラーハンドリング"
                - "リダイレクト処理"
              notes: "src/routes/auth/callback/+server.ts, auth/error/+page.svelte実装済み"

        # ST012: データをクラウドに保存する
        - id: ST012
          title: "データをクラウドに保存する"
          status: completed
          priority: 12
          solution: SL005
          screens: [SC001]
          tasks:
            - id: ST012-T1
              title: "StorageAdapterインターフェース"
              status: completed
              estimate: 30m
              depends_on: [ST010-T1]
              acceptance:
                - "load/save/saveBoard/deleteBoardメソッド定義"
                - "アダプターパターンで切り替え可能"
              notes: "src/lib/utils/storageAdapter.ts実装済み"

            - id: ST012-T2
              title: "LocalStorageAdapter実装"
              status: completed
              estimate: 1h
              depends_on: [ST012-T1]
              acceptance:
                - "既存storage.tsのアダプター化"
                - "StorageAdapterインターフェース準拠"
              notes: "src/lib/utils/localStorageAdapter.ts実装済み"

            - id: ST012-T3
              title: "SupabaseAdapter実装"
              status: completed
              estimate: 2h
              depends_on: [ST012-T1, ST011-T1]
              acceptance:
                - "boards/cellsテーブルへのCRUD"
                - "リレーション一括取得（N+1対策）"
                - "バッチupsert（パフォーマンス最適化）"
              notes: "src/lib/utils/supabaseAdapter.ts実装済み、select('*, cells(*)')で一括取得"

            - id: ST012-T4
              title: "Supabase型定義"
              status: completed
              estimate: 1h
              depends_on: [ST012-T3]
              acceptance:
                - "Database型定義"
                - "boards/cellsテーブルのRow/Insert/Update型"
                - "Relationships定義"
              notes: "src/lib/supabase/types.ts実装済み"

            - id: ST012-T5
              title: "boardStoreアダプター統合"
              status: completed
              estimate: 1.5h
              depends_on: [ST012-T2, ST012-T3]
              acceptance:
                - "認証状態に応じたアダプター切り替え"
                - "initializeWithAdapter関数"
                - "アダプター切り替え時のデータ再読み込み"
              notes: "boardStore.ts setStorageAdapter実装済み"

        # ST013: ローカルとクラウドのデータをマージする
        - id: ST013
          title: "ローカルとクラウドのデータをマージする"
          status: completed
          priority: 13
          solution: SL005
          screens: [SC001]
          tasks:
            - id: ST013-T1
              title: "データマージロジック"
              status: completed
              estimate: 1.5h
              depends_on: [ST012-T5]
              acceptance:
                - "ローカルデータとクラウドデータの統合"
                - "重複ボードの検出（ID/名前）"
                - "updatedAtによる競合解決"
              notes: "src/lib/utils/dataMerge.ts mergeAppStates実装済み"

            - id: ST013-T2
              title: "ログイン時マージフロー"
              status: completed
              estimate: 1h
              depends_on: [ST013-T1]
              acceptance:
                - "ログイン成功後にマージ実行"
                - "マージ結果をクラウドに保存"
                - "ローカルデータのクリア"
              notes: "+layout.svelte onAuthStateChangeでマージ実行"

  # 実装順序（依存関係考慮）
  implementation_order:
    phase_1:
      name: "基盤構築"
      tasks: [FND001-T1, FND001-T2, FND001-T3, FND001-T4]
      milestone: "開発環境Ready"

    phase_2:
      name: "コア機能（ボード+入力+保存）"
      tasks: [ST001-T1, ST001-T2, ST001-T3, ST001-T4, ST010-T1, ST010-T2, ST010-T3, ST005-T1, ST005-T2, ST005-T3]
      milestone: "目標入力・保存が動作"

    phase_3:
      name: "達成機能"
      tasks: [ST006-T1, ST006-T2, ST007-T1, ST007-T2]
      milestone: "達成マーク・進捗表示"

    phase_4:
      name: "ビンゴ演出"
      tasks: [ST008-T1, ST008-T2, ST008-T3, ST009-T1, ST009-T2]
      milestone: "ビンゴ達成体験完成"

    phase_5:
      name: "ボード管理"
      tasks: [ST002-T1, ST002-T2, ST003-T1, ST003-T2, ST004-T1, ST004-T2]
      milestone: "MVP完成"

    phase_6:
      name: "認証・クラウド同期"
      tasks: [ST011-T1, ST011-T2, ST011-T3, ST011-T4, ST012-T1, ST012-T2, ST012-T3, ST012-T4, ST012-T5, ST013-T1, ST013-T2]
      milestone: "認証・クラウド同期完成"

  # サマリー
  summary:
    total_stories: 13
    total_tasks: 43
    estimated_total: "約35時間"
    critical_path: [FND001, ST001, ST005, ST006, ST008, ST011, ST012]

    # 2026-01-17 タスクリファイン結果
    completion_status:
      stories_completed: 13
      stories_total: 13
      tasks_completed: 43
      tasks_total: 43
      completion_rate: "100%"

    test_coverage:
      test_files: 15
      test_cases: 155
      all_passing: true

    implementation_notes:
      - "SvelteKit v2.49.1 + Svelte 5 採用"
      - "Vitest v4.0.17 + Testing Library でテスト環境構築"
      - "canvas-confetti でビンゴ演出実装"
      - "LocalStorage + 500msデバウンスで自動保存"
      - "longPress action で長押し達成トグル"
      - "Supabase Auth + PostgreSQL でクラウド同期"
      - "StorageAdapterパターンでローカル/クラウド切り替え"
      - "select('*, cells(*)')でN+1問題解消"
      - "バッチupsertでパフォーマンス最適化"
